# SAFE-T1101: Command Injection
# This rule detects potential Command Injection attempts
# Note: This is an example rule. Attackers continuously develop new techniques.

title: Command Injection Detection
id: e9e6b337-27de-4d7d-aec5-54a4c145ae0a
status: experimental
description: Detects potential Command Injection attempts in MCP environments
author: SAFE-MCP Team
date: '2025-09-28'
references:
- https://github.com/safe-mcp/techniques/SAFE-T1101
logsource:
  product: mcp
  service: tool_invocation
detection:
  selection:
    tool_name|contains:
    - '*<!-- SYSTEM:*'
    - '*<|system|>*'
    - '*[INST]*'
    - '*### Instruction:*'
  condition: selection
falsepositives:
- Legitimate operations that match detection patterns
- Authorized administrative activities
- Security testing and research activities
level: high
tags:
- attack.unknown
- safe.t1101
- attack.t1059
